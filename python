...  /* tu b√∫squeda y filtros */
| bin _time span=1h
| stats count AS Correos
        count(eval(user="acordodigital@santander.com.br"))            AS acordodigital
        count(eval(user="notificaciones@notificaciones.santander.com.mx")) AS notificacionesSanMX
        count(eval(user="faturapromeial@santander.com.br"))            AS faturapromeial
        count(eval(user="mensajeria@santander.cl"))                    AS mensajeria
        count(eval(user="notificaciones@santander.com.mx"))            AS notificacionesMX
        count(eval(user!="acordodigital@santander.com.br"
                 AND user!="notificaciones@notificaciones.santander.com.mx"
                 AND user!="faturapromeial@santander.com.br"
                 AND user!="mensajeria@santander.cl"
                 AND user!="notificaciones@santander.com.mx"))        AS Otros
        BY _time
| sort _time
| addcoltotals
| eval _time = if(isnull(_time), "Total", _time)

| foreach acordodigital notificacionesSanMX faturapromeial mensajeria notificacionesMX [
    eval <<FIELD>> = if('<<FIELD>>'=0, 
                        "0", 
                        if(100*'<<FIELD>>'/Correos>20, 
                           "<span style=\"color:red\">" + replace(tostring('<<FIELD>>',"commas"),",",".") + " (" + tostring(round(100*'<<FIELD>>'/Correos,2)) + "%)</span>", 
                           replace(tostring('<<FIELD>>',"commas"),",",".") + " (" + tostring(round(100*'<<FIELD>>'/Correos,2)) + "%)" )
                       )
  ]

| eval Correos = replace(tostring(Correos,"commas"),",",".")
| rename _time AS Tiempo
